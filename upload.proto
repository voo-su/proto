syntax = "proto3";

package upload;

import "common/common.proto";

option go_package = "voo.su/api/app/pb;pb";

service UploadService {
  // Uploading a file part
  rpc SaveFilePart (SaveFilePartRequest) returns (SaveFilePartResponse);

  // Returns content of a whole file or its part
  rpc GetFile (GetFileRequest) returns (GetFileResponse);
}

message SaveFilePartRequest {
  // Unique file id (the same for all parts of a single file)
  int64 file_id = 1;

  // File part number (starting from 0)
  int32 file_part = 2;

  bytes bytes = 3;
}

message SaveFilePartResponse {
  bool success = 1;
}

message GetFileRequest {
  // Number of bytes to be skipped
  int64 offset = 1;

  // Number of bytes to be returned
  int32 limit = 2;

  oneof location {
    common.InputPhotoFileLocation photo_file_location = 3;
    common.InputDocumentFileLocation document_file_location = 4;
  }
}

message GetFileResponse {
  bytes bytes = 1;
}
